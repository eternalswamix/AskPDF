{% extends "base_dark.html" %}
{% block title %}Profile • PDF.AI{% endblock %}

{% block content %}
<section class="max-w-3xl mx-auto reveal">

  <div class="flex items-start justify-between gap-4 mb-6">
    <div>
      <h1 class="text-3xl font-black text-gradient">Profile</h1>
      <p class="text-slate-400 mt-1">
        Manage your account settings and update username.
      </p>
    </div>

    <a href="{{ url_for('pdf.upload_pdf') }}"
       class="hidden sm:inline-flex items-center gap-2 glass-card neon-border hover-glow px-4 py-2 rounded-xl hover:bg-white/10 transition">
      <span class="material-symbols-outlined text-sm">upload_file</span>
      Upload PDF
    </a>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

    <div class="glass-card neon-border hover-glow rounded-2xl p-8">
      <h2 class="text-xl font-bold">Account Info</h2>
      <p class="text-slate-400 text-sm mt-1">These details are stored in Supabase.</p>

      <div class="mt-6 space-y-4 text-sm">
        <div class="flex justify-between border-b border-white/10 pb-3">
          <span class="text-slate-400">Email</span>
          <span class="text-slate-200 font-semibold">{{ user_db.email }}</span>
        </div>

        <div class="flex justify-between border-b border-white/10 pb-3">
          <span class="text-slate-400">Username</span>
          <span class="text-slate-200 font-semibold">@{{ user_db.username }}</span>
        </div>

        <div class="flex justify-between border-b border-white/10 pb-3">
          <span class="text-slate-400">Name</span>
          <span class="text-slate-200 font-semibold">
            {{ user_db.first_name or "-" }} {{ user_db.last_name or "" }}
          </span>
        </div>

        <div class="flex justify-between">
          <span class="text-slate-400">Phone</span>
          <span class="text-slate-200 font-semibold">{{ user_db.phone_no or "-" }}</span>
        </div>
      </div>
    </div>

    <div class="glass-card neon-border hover-glow rounded-2xl p-8">
      <h2 class="text-xl font-bold">Change Username</h2>
      <p class="text-slate-400 text-sm mt-1">
        Choose a unique username (no spaces).
      </p>

      {% if error %}
        <div class="mt-5 bg-red-500/10 border border-red-500/30 text-red-200 text-sm rounded-xl p-3">
          ❌ {{ error }}
        </div>
      {% endif %}

      {% if success %}
        <div class="mt-5 bg-green-500/10 border border-green-500/30 text-green-200 text-sm rounded-xl p-3">
          {{ success }}
        </div>
      {% endif %}

      <form method="POST" class="mt-6 space-y-4">
        <div>
          <label class="text-sm text-slate-300">New username</label>
          <input name="username" type="text" required
            value="{{ user_db.username }}"
            class="mt-1 w-full rounded-xl bg-black/20 border border-white/10 text-white placeholder:text-slate-500 focus:border-primary focus:ring-primary"
            placeholder="new username" />
          <p class="text-xs text-slate-500 mt-1">Must be unique. Minimum 3 characters.</p>
        </div>

        <button type="submit"
          class="w-full hover-glow bg-primary text-white py-3 rounded-xl font-bold shadow-lg shadow-primary/20">
          Update Username
        </button>
      </form>
    </div>

  </div>
</section>
{% endblock %}
